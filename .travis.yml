sudo: required
dist: trusty
install: git clone https://github.com/QubesOS/qubes-builder ~/qubes-builder
# debootstrap in trusty is old...
before_script:
 - sudo ln -s sid /usr/share/debootstrap/scripts/stretch
 - export VERBOSE=3
 - export DEBUG=1
#- export REPO_PROXY=http://127.0.0.1:3142
 - export CHECK_BRANCH=1
 - export BRANCH_template_whonix=master
 - export GIT_URL_template_whonix=https://github.com/adrelanos/qubes-template-whonix.git
 - env
 - gpg --recv-keys "916B 8D99 C38E AF5E 8ADC  7A2A 8D66 066A 2EEA CCDA"
 - gpg --fingerprint "916B 8D99 C38E AF5E 8ADC  7A2A 8D66 066A 2EEA CCDA"
script: ~/qubes-builder/scripts/travis-build linux-template-builder
after_success:
 - ls -l ~/qubes-builder/qubes-src/linux-template-builder/rpm/noarch
language: generic
env:
# - DISTS_VM=jessie USE_QUBES_REPO_VERSION=3.1
# - DISTS_VM=jessie+standard USE_QUBES_REPO_VERSION=3.1
# - DISTS_VM=stretch USE_QUBES_REPO_VERSION=3.1
# - DISTS_VM=jessie USE_QUBES_REPO_VERSION=3.2 USE_QUBES_REPO_TESTING=1
# - DISTS_VM=jessie+standard USE_QUBES_REPO_VERSION=3.2 USE_QUBES_REPO_TESTING=1
# - DISTS_VM=stretch USE_QUBES_REPO_VERSION=3.2 USE_QUBES_REPO_TESTING=1
 - BUILDER_PLUGINS="template-whonix builder-debian" DISTS_VM=whonix-gateway USE_QUBES_REPO_VERSION=3.2 USE_QUBES_REPO_TESTING=1
# - DISTS_VM=whonix-workstation USE_QUBES_REPO_VERSION=3.2 USE_QUBES_REPO_TESTING=1
